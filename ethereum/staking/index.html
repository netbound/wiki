<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Staking on Ethereum with Rocketpool | Netbound Wiki</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://wiki.netbound.io/ethereum/staking"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Staking on Ethereum with Rocketpool | Netbound Wiki"><meta data-react-helmet="true" name="description" content="To participate as a validator in Ethereum consensus, we have to stake 32 ETH, which is a lot. With Rocketpool, node operators"><meta data-react-helmet="true" property="og:description" content="To participate as a validator in Ethereum consensus, we have to stake 32 ETH, which is a lot. With Rocketpool, node operators"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://wiki.netbound.io/ethereum/staking"><link data-react-helmet="true" rel="alternate" href="https://wiki.netbound.io/ethereum/staking" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://wiki.netbound.io/ethereum/staking" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.884c4f18.css">
<link rel="preload" href="/assets/js/runtime~main.5985dc6a.js" as="script">
<link rel="preload" href="/assets/js/main.a5eac2b1.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Netbound Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Netbound Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Netbound Wiki</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/netbound/wiki" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/">Intro</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Ethereum</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ethereum/staking">Staking on Ethereum with Rocketpool</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Go</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Networking</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Staking on Ethereum with Rocketpool</h1></header><p>To participate as a validator in Ethereum consensus, we have to stake 32 ETH, which is a lot. With Rocketpool, node operators
only require 16 ETH to get started, and since that&#x27;s all I have right now, this is what this document covers. This guide assumes
a Linux machine, and I&#x27;m using Ubuntu 20.04 LTS.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="execution-node-erigon"></a>Execution Node: Erigon<a class="hash-link" href="#execution-node-erigon" title="Direct link to heading">#</a></h2><p>For our execution node, we&#x27;ll go with <a href="https://github.com/ledgerwatch/erigon" target="_blank" rel="noopener noreferrer">Erigon</a>. Erigon is a modular Ethereum archive node
with a very efficient initial sync that runs in stages, and a relatively small, flat key-value database store. Erigon is
written in Go, and there are some other clients on the way that follow this new architecture, e.g.
<a href="https://github.com/torquem-ch/silkworm" target="_blank" rel="noopener noreferrer">Silkworm (C++)</a> and <a href="https://github.com/akula-bft/akula" target="_blank" rel="noopener noreferrer">Akula (Rust)</a>.</p><p>Archive nodes store and validate the complete Ethereum chain, right from block 0. This can be interesting if you want
to inspect historical events, and do historical transaction tracing. There are some cool projects that build on these
properties of Erigon:</p><ul><li><a href="https://trueblocks.io/" target="_blank" rel="noopener noreferrer">Trueblocks</a>, a chain indexer to query the Ethereum blockchain</li><li><a href="https://github.com/wmitsuda/otterscan" target="_blank" rel="noopener noreferrer">Otterscan</a>, a block explorer like Etherscan, but local (and faster)</li></ul><p>Another fact about Erigon is that it is built in a modular way - you can run the RPC API, the transaction pool, or even the
p2p stack as different processes that communicate back to the main erigon process over gRPC. </p><p>The modular architecture brings with it some great benefits, including the ability to run multiple rpcdaemons at once, or run
the rpcdaemon on another machine. We&#x27;ll just do it because there are some RPC methods that require a separate rpcdaemon.
You can find more info on their <a href="https://github.com/ledgerwatch/erigon/wiki" target="_blank" rel="noopener noreferrer">Github Wiki</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="statistics"></a>Statistics<a class="hash-link" href="#statistics" title="Direct link to heading">#</a></h3><p>Syncing an Erigon archive node took around 76 hours in total on the following machine:</p><ul><li>CPU: AMD Ryzen 9 3900x (12 cores, 4.6 GHz)</li><li>SSD: logical volume of 1 2TB Corsair Force MP600 and one 2TB Seagate Ironwolf 510</li><li>RAM: 64GB of DDR4 (Corsair Vengeance, 2x 32 GB modules)</li></ul><p>The sync consumed 700 GB of network traffic, and the total database size is 1.6 TB. If you run
a geth node in archive mode, you&#x27;ll need more than 6 TB of disk space.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="prerequisites"></a>Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h3><ul><li><a href="https://go.dev/doc/install" target="_blank" rel="noopener noreferrer">Install Go</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="installation"></a>Installation<a class="hash-link" href="#installation" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone --recurse-submodules -j8 https://github.com/ledgerwatch/erigon.git</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> erigon</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> checkout stable</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> erigon</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We&#x27;ll run the RPC API, <code>rpcdaemon</code> in Erigon lingo, as a separate process, so we have to build that too:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">make</span><span class="token plain"> rpcdaemon</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>After building, we&#x27;ll move the erigon directory to <code>/srv</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> erigon /srv/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This is the location where our systemd services will start the processes from.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="consensus-node-lighthouse"></a>Consensus Node: Lighthouse<a class="hash-link" href="#consensus-node-lighthouse" title="Direct link to heading">#</a></h2><p>As a consensus node, we&#x27;re going to install Lighthouse, built with Rust.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="prerequisites-1"></a>Prerequisites<a class="hash-link" href="#prerequisites-1" title="Direct link to heading">#</a></h3><ul><li><a href="https://www.rust-lang.org/tools/install" target="_blank" rel="noopener noreferrer">Install Rust</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="installation-1"></a>Installation<a class="hash-link" href="#installation-1" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/sigp/lighthouse.git</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> lighthouse</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> checkout stable</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Move to system directory</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> lighthouse /srv/</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To update:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> /srv/lighthouse</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> fetch</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> checkout </span><span class="token variable" style="color:#36acaa">${VERSION}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">make</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="rocketpool"></a>Rocketpool<a class="hash-link" href="#rocketpool" title="Direct link to heading">#</a></h2><blockquote><p>Rocket Pool is the base layer protocol for decentralised and trustless ETH2 staking.</p></blockquote><p>With Rocketpool, node operators can collaborate with stakers to create validators. A node operator (us) runs the infrastructure
(execution, beacon node and validator), and stakes 16 ETH of his own together with some <strong>RPL</strong> tokens (10% of staked ETH) as collateral for slashing and performance insurance.
Stakers can more easily participate because they only require a small amount of ETH to get started. Essentially, Rocketpool splits the difference between those who have the technical skills to run and maintain a node and those who lack the financial capacity to own 32 ETH.</p><p>As a node operator, you&#x27;ll also get more ROI in the form of the slashing insurance premiums (RPL) and a commission rate (ETH).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="setup"></a>Setup<a class="hash-link" href="#setup" title="Direct link to heading">#</a></h2><p>We&#x27;re going to run the execution and consensus clients as <a href="https://en.wikipedia.org/wiki/Systemd" target="_blank" rel="noopener noreferrer">systemd</a> services,
each with their own service accounts. The service accounts will have limited access to the rest of the system,
so if one of the clients is compromised, the damage will be contained. The Rocketpool smart node stack will run in Docker containers.
This is the <a href="https://docs.rocketpool.net/guides/node/hybrid.html" target="_blank" rel="noopener noreferrer">Hybrid Rocket Pool Node</a> configuration.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Storage</h5></div><div class="admonition-content"><p>The disks you will use as storage should be SSDs, HDD won&#x27;t cut it. I&#x27;ve mounted some NVMe drives as logical volumes,
so that I can easily increase capacity in the future. Stats:</p><ul><li>Erigon drive: 4 TB (right now, state is about 1.6 TB) NVMe</li><li>Lighthouse drive: 1 TB NVMe</li></ul></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="setting-up-the-services"></a>Setting up the services<a class="hash-link" href="#setting-up-the-services" title="Direct link to heading">#</a></h3><p>Let&#x27;s start by creating the service accounts (without login) and service groups:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># -r is for system account, -s specifies shell</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useradd</span><span class="token plain"> -r -s /sbin/nologin erigon</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useradd</span><span class="token plain"> -r -s /sbin/nologin lighthouse</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># service group</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">groupadd</span><span class="token plain"> ethereum</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Next, change the ownership of the client directories:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> -R erigon:ethereum /srv/erigon</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> -R lighthouse:ethereum /srv/lighthouse</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We have to be part of the <code>ethereum</code> group with our main account to have write access
to the directories (for updating):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">usermod</span><span class="token plain"> -aG ethereum </span><span class="token environment constant" style="color:#36acaa">$USER</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="systemd-service-files"></a>Systemd service files<a class="hash-link" href="#systemd-service-files" title="Direct link to heading">#</a></h4><p>We&#x27;ll need the following systemd services:</p><ul><li>Erigon execution client</li><li>Rpcdaemon for Erigon</li><li>Lighthouse beacon node</li></ul><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">/etc/systemd/system/erigon.service</div><div class="codeBlockContent_hGly service"><pre tabindex="0" class="prism-code language-service codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Description=Erigon</span></span><span class="token-line" style="color:#393A34"><span class="token plain">After=network.target</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[Service]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Type=simple</span></span><span class="token-line" style="color:#393A34"><span class="token plain">User=erigon</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Restart=always</span></span><span class="token-line" style="color:#393A34"><span class="token plain">RestartSec=5</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/srv/erigon/build/bin/erigon --datadir /mnt/eth-archive --maxpeers 100</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[Install]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">WantedBy=multi-user.target</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">/etc/systemd/system/rpcdaemon.service</div><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Description=Rpcdaemon</span></span><span class="token-line" style="color:#393A34"><span class="token plain">After=network.target erigon.service</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Wants=erigon.service</span></span><span class="token-line" style="color:#393A34"><span class="token plain">PartOf=erigon.service</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[Service]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Type=simple</span></span><span class="token-line" style="color:#393A34"><span class="token plain">User=erigon</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Restart=always</span></span><span class="token-line" style="color:#393A34"><span class="token plain">RestartSec=5</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/srv/erigon/build/bin/rpcdaemon --datadir /mnt/eth-archive --ws --http.addr 0.0.0.0 --http.api eth,net,trace,erigon,web3</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[Install]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">WantedBy=multi-user.target</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">/etc/systemd/system/lh-bn.service</div><div class="codeBlockContent_hGly service"><pre tabindex="0" class="prism-code language-service codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">[Unit]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Description=Lighthouse Beacon Node</span></span><span class="token-line" style="color:#393A34"><span class="token plain">After=network.target rpcdaemon.service</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Wants=rpcdaemon.service</span></span><span class="token-line" style="color:#393A34"><span class="token plain">PartOf=rpcdaemon.service</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[Service]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Type=simple</span></span><span class="token-line" style="color:#393A34"><span class="token plain">User=lighthouse</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Restart=always</span></span><span class="token-line" style="color:#393A34"><span class="token plain">RestartSec=5</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/srv/lighthouse/target/release/lighthouse beacon --network mainnet --datadir /mnt/evo/lighthouse --port 9001 --discovery-port 9001 --eth1 --eth1-endpoints http://localhost:8545 --http --http-address 0.0.0.0 --http-port 5052 --eth1-blocks-per-log-query 150 --disable-upnp</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[Install]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">WantedBy=multi-user.target</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Listening addresses</h5></div><div class="admonition-content"><p>The HTTP addresses on rpcdaemon and Lighthouse were changed to 0.0.0.0, because the Rocketpool node, which runs in a Docker container,
otherwise can&#x27;t reach them. But beware, these APIs are now listening on public interfaces, so make sure your firewall is running.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="installing-rocketpool"></a>Installing Rocketpool<a class="hash-link" href="#installing-rocketpool" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="installing-the-cli"></a>Installing the CLI<a class="hash-link" href="#installing-the-cli" title="Direct link to heading">#</a></h4><p>We download the CLI following <a href="https://docs.rocketpool.net/guides/node/docker.html#downloading-the-rocket-pool-cli" target="_blank" rel="noopener noreferrer">this Rocketpool guide</a>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://github.com/rocket-pool/smartnode-install/releases/latest/download/rocketpool-cli-linux-amd64 -O ./rocketpool</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Mark as executable and move to somewhere in $PATH</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> +x ./rocketpool </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mv</span><span class="token plain"> ./rocketpool /usr/local/bin</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Test running it with the <code>--version</code> flag, which should output something like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ rocketpool --version</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool version 1.1.0</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="installing-the-smartnode-stack"></a>Installing the Smartnode Stack<a class="hash-link" href="#installing-the-smartnode-stack" title="Direct link to heading">#</a></h4><p>We can install the Smartnode Stack for mainnet like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Next, add yourself to the <code>docker</code> group to use Docker without root privileges:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">usermod</span><span class="token plain"> -aG docker </span><span class="token environment constant" style="color:#36acaa">$USER</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You will have to restart your SSH session for these changes to take effect.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Docker installation</h5></div><div class="admonition-content"><p>This will download Docker and docker-compose for you, if you already have these installed, run:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> -d </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will tell rocketpool to skip the dependencies.</p></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="basic-configuration"></a>Basic Configuration<a class="hash-link" href="#basic-configuration" title="Direct link to heading">#</a></h4><p>Run the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> config</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will start an interactive process to help with the configuration.
For our ETH1 client, even though we&#x27;re using Erigon, you can select Geth (1) and leave all the default options.
We will later modify these.</p><p>For the ETH2 configuration, make sure to select Lighthouse. This is important, since the validator node
is part of the Smartnode Stack and needs to be the same client as our Beacon Node. The default settings will do, but you can
add your own custom Graffiti! This will be included on every block your validator produces, which is pretty cool.</p><p>As we&#x27;ve seen, the Smartnode Stack runs with docker-compose. We&#x27;ll need to change the original compose file:</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">~/.rocketpool/docker-compose.yml</div><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;3.4&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">eth1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">ETH1_IMAGE</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">eth2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">ETH2_IMAGE</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">validator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">VALIDATOR_IMAGE</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">api</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">SMARTNODE_IMAGE</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">entrypoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /bin/sleep</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;infinity&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">node</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">SMARTNODE_IMAGE</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth2</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">watchtower</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">SMARTNODE_IMAGE</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">depends_on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth2</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Delete both the <code>eth1</code> and <code>eth2</code> sections of the configuration, and if they are in another services&#x27; <code>depends_on</code> section,
remove them there too.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="creating-docker-networks"></a>Creating Docker Networks<a class="hash-link" href="#creating-docker-networks" title="Direct link to heading">#</a></h4><p>Right now, we&#x27;re going to start and stop the smartnode stack. It won&#x27;t work yet, but it will create the necessary Docker networks, which
we need for later configuration.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> start</span></span><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> stop</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will have created a Docker network <code>rocketpool_net</code>. Find the subnet with:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker inspect rocketpool_net </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> jq .</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">.IPAM.Config</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">.Subnet</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">SUBNET</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;172.18.0.0/16&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>We can now configure the firewall.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="firewall-using-ufw"></a>Firewall (using UFW)<a class="hash-link" href="#firewall-using-ufw" title="Direct link to heading">#</a></h3><p>We need to open the correct ports on our machine:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Erigon</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> ufw allow </span><span class="token number" style="color:#36acaa">30303</span><span class="token plain"> comment </span><span class="token string" style="color:#e3116c">&quot;Erigon eth65 p2p&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> ufw allow </span><span class="token number" style="color:#36acaa">30304</span><span class="token plain"> comment </span><span class="token string" style="color:#e3116c">&quot;Erigon eth66 p2p&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># where $SUBNET is the Docker subnet you noted before</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> ufw allow from </span><span class="token variable" style="color:#36acaa">$SUBNET</span><span class="token plain"> to any port </span><span class="token number" style="color:#36acaa">8545</span><span class="token plain"> comment </span><span class="token string" style="color:#e3116c">&quot;Rocketpool to Erigon&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Lighthouse</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> ufw allow </span><span class="token number" style="color:#36acaa">9001</span><span class="token plain"> comment </span><span class="token string" style="color:#e3116c">&quot;Lighthouse p2p&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> ufw allow from </span><span class="token variable" style="color:#36acaa">$SUBNET</span><span class="token plain"> to any port </span><span class="token number" style="color:#36acaa">5052</span><span class="token plain"> comment </span><span class="token string" style="color:#e3116c">&quot;Rocketpool to Lighthouse beacon node&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Right now the APIs are only reacheable from inside the Docker containers. If you want to reach them from other machines on your network,
configure the firewall accordingly.</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Port forwarding</h5></div><div class="admonition-content"><p>If your machine is behind a router or firewall, make sure to configure port forwarding. This is important for maintaining good
connectivity and allowing other peers to discover you.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="configuring-rocketpool"></a>Configuring Rocketpool<a class="hash-link" href="#configuring-rocketpool" title="Direct link to heading">#</a></h3><p>We&#x27;ve already done some basic configuration in <code>~/.rocketpool/docker-compose.yml</code>, but we&#x27;re not done yet.
The next file we need to configure is <code>~/.rocketpool/config.yml</code>:</p><div class="codeBlockContainer_K1bP"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_eoMF">~/.rocketpool/config.yml</div><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">rocketpool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">smartnode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">chains</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">eth1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//eth1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">8545</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">wsProvider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ws</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//eth1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">8546</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">eth2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">provider</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//eth2</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">5052</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">...</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The hosts that are filled in by default (<code>eth1</code>, <code>eth2</code>) are normally resolved inside of the Docker network.
Since we&#x27;re not running these services as Docker containers, we&#x27;ll need to modify them. Replace
all the providers with the gateway IP of <code>$SUBNET</code> (if your SUBNET was <code>172.18.0.0/16</code>, your http provider will
be <code>http://172.18.0.1:8545</code>). Your ws provider will be <code>ws://172.18.0.1:8545</code>, since Erigon uses the same ports
for both HTTP and WebSockets. Do the same for the <code>eth2</code> provider.</p><p>This networking setup will work since we configured UFW to accept connections coming from the Docker network.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="running"></a>Running<a class="hash-link" href="#running" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="starting-the-rocketpool-service"></a>Starting the Rocketpool Service<a class="hash-link" href="#starting-the-rocketpool-service" title="Direct link to heading">#</a></h3><p>We have done enough configuration for now, and can finally start the service. Use this command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> start</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating network </span><span class="token string" style="color:#e3116c">&quot;rocketpool_net&quot;</span><span class="token plain"> with the default driver</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating rocketpool_api  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating rocketpool_api  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span><span class="token keyword" style="color:#00009f">done</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating rocketpool_watchtower </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating rocketpool_node       </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating rocketpool_validator  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating rocketpool_validator  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span><span class="token keyword" style="color:#00009f">done</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating rocketpool_node       </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span><span class="token keyword" style="color:#00009f">done</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">Creating rocketpool_watchtower </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span><span class="token keyword" style="color:#00009f">done</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>I have included the output, and this is more or less what your output should look like as well. </p><p>If you need to stop the service to do some system maintenance or upgrade the rocketpool stack, use:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> stop</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Are you sure you want to pause the Rocket Pool service? Any staking minipools will be penalized</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">y/n</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">y</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">Stopping rocketpool_node       </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span></span><span class="token-line" style="color:#393A34"><span class="token plain">Stopping rocketpool_validator  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span></span><span class="token-line" style="color:#393A34"><span class="token plain">Stopping rocketpool_watchtower </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span></span><span class="token-line" style="color:#393A34"><span class="token plain">Stopping rocketpool_api        </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span></span><span class="token-line" style="color:#393A34"><span class="token plain">Stopping rocketpool_validator  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span><span class="token keyword" style="color:#00009f">done</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">Stopping rocketpool_node       </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span><span class="token keyword" style="color:#00009f">done</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">Stopping rocketpool_watchtower </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span><span class="token keyword" style="color:#00009f">done</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">Stopping rocketpool_api        </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span><span class="token keyword" style="color:#00009f">done</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="checking-the-services"></a>Checking the Services<a class="hash-link" href="#checking-the-services" title="Direct link to heading">#</a></h4><p>We can check the service version and networks with <code>rocketpool service version</code>.</p><p>Checking if all the containers are running can be done with <code>docker ps</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID   IMAGE                         COMMAND                  CREATED       STATUS      PORTS                                                 NAMES</span></span><span class="token-line" style="color:#393A34"><span class="token plain">cc23bb9f1f7c   sigp/lighthouse:v2.0.1        </span><span class="token string" style="color:#e3116c">&quot;sh /setup/start-valâ€¦&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> days ago    Up </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> days                                                         rocketpool_validator</span></span><span class="token-line" style="color:#393A34"><span class="token plain">0cbe6a5f4997   rocketpool/smartnode:v1.1.0   </span><span class="token string" style="color:#e3116c">&quot;/go/bin/rocketpool â€¦&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> days ago    Up </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> days                                                         rocketpool_node</span></span><span class="token-line" style="color:#393A34"><span class="token plain">a4223e20252e   rocketpool/smartnode:v1.1.0   </span><span class="token string" style="color:#e3116c">&quot;/go/bin/rocketpool â€¦&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> days ago    Up </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> days                                                         rocketpool_watchtower</span></span><span class="token-line" style="color:#393A34"><span class="token plain">681f8a9744c1   rocketpool/smartnode:v1.1.0   </span><span class="token string" style="color:#e3116c">&quot;/bin/sleep infinity&quot;</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> days ago    Up </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> days                                                         rocketpool_api</span></span><span class="token-line" style="color:#393A34"><span class="token plain">b1dc152f1391   grafana/grafana:8.1.1         </span><span class="token string" style="color:#e3116c">&quot;/run.sh&quot;</span><span class="token plain">                </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> weeks ago   Up </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> days   </span><span class="token number" style="color:#36acaa">3000</span><span class="token plain">/tcp, </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:3100-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">3100</span><span class="token plain">/tcp, :::3100-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">3100</span><span class="token plain">/tcp   rocketpool_grafana</span></span><span class="token-line" style="color:#393A34"><span class="token plain">fcfa50d3f3bf   prom/node-exporter:v1.2.2     </span><span class="token string" style="color:#e3116c">&quot;/bin/node_exporter â€¦&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> weeks ago   Up </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> days                                                         rocketpool_exporter</span></span><span class="token-line" style="color:#393A34"><span class="token plain">e274309e596a   prom/prometheus:v2.28.1       </span><span class="token string" style="color:#e3116c">&quot;/bin/prometheus --wâ€¦&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> weeks ago   Up </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> days   </span><span class="token number" style="color:#36acaa">9090</span><span class="token plain">/tcp                                              rocketpool_prometheus</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>This might look different if you didn&#x27;t configure for analytics during the setup.</p></div></div><p>Further logs can be obtained with <code>rocketpool service logs</code> for all logs, or <code>rocketpool service logs &lt;service&gt;</code>, to get the logs
for a specific service (<code>validator</code> or <code>node</code> for example).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="setting-up-a-wallet"></a>Setting up a Wallet<a class="hash-link" href="#setting-up-a-wallet" title="Direct link to heading">#</a></h3><p>Now that all the services are running, we need to set up an ETH1 wallet for the node. This wallet will</p><ul><li>Hold ETH to pay for various actions on the network (creating a new minipool, staking your RPL)</li><li>Hold the ETH that you&#x27;re going to send to your minipool to start staking</li><li>Hold the RPL that you&#x27;re going to stake</li></ul><p>We&#x27;re going to use the <code>rocketpool</code> cli to create this wallet:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool wallet init</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will prompt you for a password to protect your private key and give you back a 24-word mnemonic that
is your recovery phrase. Your password will be written to <code>~/.rocketpool/data/password</code> in CLEARTEXT, so make sure
there&#x27;s no one else on your system. Your wallet private key is at <code>~/.rocketpool/data/wallet</code>.</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>Please write down your recovery phrase, but KEEP IT SAFE. This phrase can be used to import your wallet
and all validators attached to a new machine, and anyone that has this phrase has full control over your
private key.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="loading-up-the-funds"></a>Loading up the Funds<a class="hash-link" href="#loading-up-the-funds" title="Direct link to heading">#</a></h3><p>Before we can create a minipool, we need 16 ETH, extra ETH for gas fees, and some RPL in our node wallet.
The RPL value should be at least 10% of the value of your ETH in USD. You can read more about the purpose of
RPL in <strong><a href="#sources">[3]</a></strong>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="registering-the-node"></a>Registering the Node<a class="hash-link" href="#registering-the-node" title="Direct link to heading">#</a></h3><p>Once the funds are in the wallet, we can register our node with the Rocketpool network:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool node register</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will prompt you for your timezone, as well as sending a transaction. Make sure the gas price is not ridiculously high.
You can now check your RPL and ETH balances:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool node status</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>By default, all your RPL rewards, as well as your staked ETH and RPL will be sent to your wallet address when claiming the
rewards or exiting your validator. If you want to change this, follow <a href="https://docs.rocketpool.net/guides/node/prepare-node.html#setting-your-withdrawal-address" target="_blank" rel="noopener noreferrer">this guide</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="setting-up-a-minipool"></a>Setting up a Minipool<a class="hash-link" href="#setting-up-a-minipool" title="Direct link to heading">#</a></h3><p>This is where things get interesting, and potentially dangerous. Make sure you&#x27;re ready to stake 16 or 32 ETH, as well as a
non-trivial amount of RPL. Also make sure your secrets are secret, and be diligent about it.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="staking-rpl"></a>Staking RPL<a class="hash-link" href="#staking-rpl" title="Direct link to heading">#</a></h4><p>The first step in setting up a validator is to stake your RPL. This should be at least 10% of the value of your ETH, and
the more you stake, the more you earn (capped at 150% of your ETH value). </p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>This stake counts for your entire node, so if
you want to run multiple minipools, this is possible without buying and staking more RPL.</p></div></div><p>Start staking with the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool node stake-rpl</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will prompt you for the amount you want to stake, so you don&#x27;t have to calculate it yourself:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Please choose an amount of RPL to stake:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">1: The minimum minipool stake amount (284.477473 RPL)?</span></span><span class="token-line" style="color:#393A34"><span class="token plain">2: The maximum effective minipool stake amount (4267.162095 RPL)?</span></span><span class="token-line" style="color:#393A34"><span class="token plain">3: Your entire RPL balance (1440.000000 RPL)?</span></span><span class="token-line" style="color:#393A34"><span class="token plain">4: A custom amount</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>On confirmation, you&#x27;ll have to allow 2 transactions. Once these are confirmed, you can check your staked balance:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool node status</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">The node has a total stake of </span><span class="token number" style="color:#36acaa">11763.477483</span><span class="token plain"> RPL and an effective stake of </span><span class="token number" style="color:#36acaa">11763.477483</span><span class="token plain"> RPL, allowing it to run </span><span class="token number" style="color:#36acaa">41</span><span class="token plain"> minipool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> total.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">This is currently a </span><span class="token number" style="color:#36acaa">10.88</span><span class="token plain">% collateral ratio.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">The node must keep at least </span><span class="token number" style="color:#36acaa">10810.143971</span><span class="token plain"> RPL staked to collateralize its minipools and claim RPL rewards.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Make sure your collateral ratio is above 10%, or you won&#x27;t be able to collect any RPL staking rewards.</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>Your nodes should be synced before moving on to the next step, or you will lose rewards.</p></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="staking-eth-and-creating-a-minipool"></a>Staking ETH and Creating a Minipool<a class="hash-link" href="#staking-eth-and-creating-a-minipool" title="Direct link to heading">#</a></h4><p>We&#x27;re now ready to finally stake our ETH and put our node up to become a validator:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool node deposit</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You will be prompted to deposit either 16 or 32 ETH, we&#x27;ll be going with 16. This will put us in the minipool queue,
where we wait for 16 ETH to become available from stakers in the rETH staking pool. Once we hit the front of the queue
and the ETH is available, it will be combined with our own 16 ETH to create a minipool and deposit the 32 ETH to the
Beacon Chain deposit contract. Thus our validator is born!</p><p>First we have to confirm the transaction though. You will have to set a commission slippage rate, but chances are the commission
rate is 5%, which is the lowest it can go. So just accept the suggested slippage rate. If this is not the case, you can read more
about it <a href="https://docs.rocketpool.net/guides/node/create-validator.html#depositing-eth-and-creating-a-minipool" target="_blank" rel="noopener noreferrer">here</a>.</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>This is an expensive transaction, and the total cost in ETH will be displayed in the prompt. Make sure you&#x27;re okay with the cost
before confirming.</p></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="confirming-minipool-creation"></a>Confirming Minipool Creation<a class="hash-link" href="#confirming-minipool-creation" title="Direct link to heading">#</a></h4><p>Confirming the succesful creation of the minipool can be done with the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">rocketpool minipool status</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Your minipool will go through a couple stages before being finalized. First, it will enter the <code>initialized</code> stage,
which means your minipool is currently in the queue waiting to be assigned 16 ETH from the network. You can check your
position in the queue <a href="https://www.rp-metrics-dashboard.com/dashboard/MAINNET" target="_blank" rel="noopener noreferrer">here</a>, where you can enter your node address.</p><p>Once the ETH is received and 32 of it is sent to the Beacon Chain contract, you will enter the <code>prelaunch</code> state. This is currently
a period of 12 hours wherein all kinds of checks are performed. After this period, your validator will be activated and the
minipool will enter the <code>staking</code> stage. You can also follow this process on <a href="https://beaconcha.in/" target="_blank" rel="noopener noreferrer">beaconcha.in</a> (find
your validator public key by looking up your node minipool creation transaction on etherscan).</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>If at any time during the process something didn&#x27;t work as expected, I suggest you to check your logs with <code>rocketpool service logs</code>.
Also look at the logs of your Erigon and Lighthouse, as something might be wrong in that part of the stack as well.</p></div></div><p>If you got here, you&#x27;re now officially a validator on the Ethereum network, congratulations! There are a couple ways to check
your rewards:</p><ul><li>You can look at beaconcha.in, but this will only show rewards for the whole validator, or</li><li>You can check out the Grafana dashboard that&#x27;s running on port <code>3100</code> (if you set it up), which will show you all kinds of cool metrics.
Read more about them <a href="https://docs.rocketpool.net/guides/node/grafana.html#overview-of-the-rocket-pool-metrics-stack" target="_blank" rel="noopener noreferrer">here</a>.
I highly recommend setting this up!</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="sources"></a>Sources<a class="hash-link" href="#sources" title="Direct link to heading">#</a></h2><p><strong>[1]</strong> <a href="https://docs.rocketpool.net" target="_blank" rel="noopener noreferrer">Rocketpool Docs</a></p><p><strong>[2]</strong> <a href="https://docs.rocketpool.net/guides/node/cli-intro.html" target="_blank" rel="noopener noreferrer">Rocketpool CLI Reference</a></p><p><strong>[3]</strong> <a href="https://medium.com/rocket-pool/rocket-pool-staking-protocol-part-3-3029afb57d4c" target="_blank" rel="noopener noreferrer">Rocketpool staking protocol part 3</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/ethereum">ethereum</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/erigon">erigon</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/tags/lighthouse">lighthouse</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/main/website/docs/ethereum/staking.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Intro</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/go/concurrency-in-go"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Concurrency in Go Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#execution-node-erigon" class="table-of-contents__link">Execution Node: Erigon</a><ul><li><a href="#statistics" class="table-of-contents__link">Statistics</a></li><li><a href="#prerequisites" class="table-of-contents__link">Prerequisites</a></li><li><a href="#installation" class="table-of-contents__link">Installation</a></li></ul></li><li><a href="#consensus-node-lighthouse" class="table-of-contents__link">Consensus Node: Lighthouse</a><ul><li><a href="#prerequisites-1" class="table-of-contents__link">Prerequisites</a></li><li><a href="#installation-1" class="table-of-contents__link">Installation</a></li></ul></li><li><a href="#rocketpool" class="table-of-contents__link">Rocketpool</a></li><li><a href="#setup" class="table-of-contents__link">Setup</a><ul><li><a href="#setting-up-the-services" class="table-of-contents__link">Setting up the services</a></li><li><a href="#installing-rocketpool" class="table-of-contents__link">Installing Rocketpool</a></li><li><a href="#firewall-using-ufw" class="table-of-contents__link">Firewall (using UFW)</a></li><li><a href="#configuring-rocketpool" class="table-of-contents__link">Configuring Rocketpool</a></li></ul></li><li><a href="#running" class="table-of-contents__link">Running</a><ul><li><a href="#starting-the-rocketpool-service" class="table-of-contents__link">Starting the Rocketpool Service</a></li><li><a href="#setting-up-a-wallet" class="table-of-contents__link">Setting up a Wallet</a></li><li><a href="#loading-up-the-funds" class="table-of-contents__link">Loading up the Funds</a></li><li><a href="#registering-the-node" class="table-of-contents__link">Registering the Node</a></li><li><a href="#setting-up-a-minipool" class="table-of-contents__link">Setting up a Minipool</a></li></ul></li><li><a href="#sources" class="table-of-contents__link">Sources</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Netbound, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.5985dc6a.js"></script>
<script src="/assets/js/main.a5eac2b1.js"></script>
</body>
</html>